FROM ubuntu:16.04 AS build

# Use bash explicitly inside RUN statements
RUN apt-get update && \
    DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends make g++ && \
    rm -rf /var/lib/apt/lists/*

WORKDIR /build

COPY ./src .

# Use bash explicitly here too
RUN bash -euxo pipefail -c "make"

FROM ubuntu:16.04

COPY --from=build /build/ITGSend/ITGSend /usr/local/bin/

ENTRYPOINT [ "ITGSend" ]

